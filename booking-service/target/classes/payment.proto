syntax = "proto3";

option java_multiple_files = true;
option java_package = "com.example.bookingservice.grpc";
option java_outer_classname = "PaymentProto";

package payment;

service PaymentGrpcService {
  rpc CreatePayment (CreatePaymentRequest) returns (PaymentResponse);
  rpc GetPayment (GetPaymentRequest) returns (PaymentResponse);
  rpc GetPaymentByBooking (GetPaymentByBookingRequest) returns (PaymentResponse);
  rpc RefundPayment (RefundPaymentRequest) returns (PaymentResponse);
  rpc ProcessVNPayCallback (VNPayCallbackRequest) returns (PaymentResponse);
}

message CreatePaymentRequest {
  string bookingId = 1;
  double amount = 2;
  string method = 3; // HOTEL or VNPAY
}

message GetPaymentRequest { string id = 1; }
message GetPaymentByBookingRequest { string bookingId = 1; }
message RefundPaymentRequest { string id = 1; }

message VNPayCallbackRequest {
  string orderId = 1;
  string responseCode = 2; // 00 success
  string transactionId = 3;
}

message PaymentResponse {
  string id = 1;
  string bookingId = 2;
  double amount = 3;
  string method = 4;
  string status = 5;
  string transactionId = 6;
  string vnpayOrderId = 7;
  string vnpayResponseCode = 8;
  string paidAt = 9; // ISO datetime
  string createdAt = 10;
  string updatedAt = 11;
}
