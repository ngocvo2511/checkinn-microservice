#!/bin/sh
# Copyright 2007-present the original author or authors.
# Licensed under the Apache License, Version 2.0

basedir=`dirname "$0"`
[ -z "$basedir" ] && basedir=.

# Use the maximum available, or set MAX_FD != -1 to use that value.
MAX_FD="maximum"

warn() {
    echo "$*"
}

die() {
    echo
    echo "$*"
    echo
    exit 1
}

# OS specific support (must be 'true' or 'false').
cygwin=false
msys=false
darwin=false
nonstop=false
case "`uname`" in
  CYGWIN* )
    cygwin=true
    ;;
  Darwin* )
    darwin=true
    ;;
  MSYS* | MINGW* )
    msys=true
    ;;
  NONSTOP* )
    nonstop=true
    ;;
esac

# Determine the Java command to use to start the JVM.
if [ -n "$JAVA_HOME" ] ; then
    if [ -x "$JAVA_HOME/jre/sh/java" ] ; then
        # IBM's JDK on AIX uses strange locations for the executables
        JAVACMD="$JAVA_HOME/jre/sh/java"
    else
        JAVACMD="$JAVA_HOME/bin/java"
    fi
    if [ ! -x "$JAVACMD" ] ; then
        die "ERROR: JAVA_HOME is set to an invalid directory: $JAVA_HOME"
    fi
else
    JAVACMD="java"
    which java >/dev/null 2>&1 || die "ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH."
fi

# Build the actual command
PRG="$0"
# Need to handle Windows specially because the default "/" might not work with paths that contain spaces
if $cygwin; then
    PRG=`cygpath --windows "$PRG"`
fi

DIRNAME=`dirname "$PRG"`
CLASSPATH="$DIRNAME/.mvn/wrapper/maven-wrapper.jar"

WRAPPER_LAUNCHER=org.apache.maven.wrapper.MavenWrapperMain

exec "$JAVACMD" \
  $MAVEN_OPTS \
  -classpath "$CLASSPATH" \
  "-Dmaven.multiModuleProjectDirectory=$DIRNAME" \
  "$WRAPPER_LAUNCHER" "$@"
